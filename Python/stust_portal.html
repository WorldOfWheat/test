<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <!--v1.0.0-->
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>南臺科技大學全校無線網路認證系統</title>    
    <link rel="stylesheet" href="jquery.mobile.custom.theme.min.css" />
    <link rel="stylesheet" href="jquery.mobile.custom.structure.min.css" />
    <script src="zepto.min.js"></script>
</head>
<body>    
    <div style="text-align:center; background-color: #E1C4FF;" data-role="header" class="ui-header ui-bar-inherit">
        <div style="font-weight:bold">南臺科技大學校園無線網路認證系統</div>
        <div>User Authentication For STUST Wireless System</div>
    </div>
    <div role="main" class="ui-content" style="background-color: #F4F4FF">
        <div style="text-align:center; margin-bottom: 5px;">
                <img src="{{ url_for('static', filename='images/stust_logo.png') }}" width="200" />                
        </div>
        <form method="post" action="/auth/index.html/u">
            <div style="text-align:center">   
                <div style="margin-bottom: 5px">
                    <label>帳號(username):</label>
                    <input type="text" name="user" accesskey="u" tabindex="1" maxlength="30" required="required" style="padding: 5px; border-style: solid; border-width: 1px;width:200px" />                        
                </div>         
                <div>
                    <label>密碼(password):</label>
                    <input type="password" name="password" accesskey="p" tabindex="2" maxlength="50" required="required" style="margin-left:1px; padding: 5px;border-style: solid; border-width: 1px;width:200px" />                        
                </div>               
                <div class="ui-field-contain" style="text-align:center">
                    <input  class="ui-btn ui-corner-all" type="submit" name="Login" value="登入(Login)" tabindex="3" style="margin-right: auto; margin-left: auto;" />
                </div>
                <label style="color: #FF0000; font-weight: bold" id="msg"></label>
            </div>        
        </form>        
        <ol style="margin-right: 20px;margin-left: 20px;" >        
            <li><span style="color: #3399FF; font-weight: bold">南臺教職員及學生</span>: 輸入Email帳號(@後都不需輸入) 及密碼。</li>
            <li><span style="color: #3399FF; font-weight: bold">外校師生</span>: 輸入所屬學校提供之完整Email帳號及密碼。例如: abcd@mail.xxx.edu.tw</li>                       
        </ol>
        <div style="margin-right: 20px;margin-left: 30px;">
            <!--<div>尚未申請iTaiwan帳號者，請先至官網<a href='https://itaiwan.gov.tw' target="_blank">https://itaiwan.gov.tw</a>申請。</div>-->
            <div style="color: #FF0000;margin-top:5px">無線網路資料為不安全的明碼傳送若連結的網站未使用加密傳輸時資料有被竊聽的風險請使用者自行決定是否要承擔該風險。</div>
        </div>        
    </div>
</body>
    <script>
        $(document).ready(function () {
            var user=$("input[name='user']");
            var pwd = $("input[name='password']");
            var rem = $("input[name='rember']");
            var remspan = $("span[id='rember']");
            var bc = "background-color";
            var ye = "#FFFF99";
            var wh = "#FFFFFF";           
            user.focusin(function () {
                $(this).css(bc, ye);
            });
            user.focusout(function () {
                $(this).css(bc, wh);
            });
            user.change(function () {
                var _user = $(this).val();
                var _suffix="@itw";
                if (_user.indexOf(_suffix, _user.length - _suffix.length) !== -1) {
                    //$("#msg").text('因應學術網路資訊安全考量，iTaiwan於7月1日將全面停止認證服務。');
                    alert('※109年7月1日起iTaiwan簡化無線上網登入方式，將無帳號可進行驗證，故無法支援iTaiwan帳號登入服務。');
                }
            });
            pwd.focusin(function () {
                $(this).css(bc, ye);
            });
            pwd.focusout(function () {
                $(this).css(bc, wh);
            });
            

            user.focus();
                     
            var url = window.location.toString();
            var str = "";
            var str_value = "";
            if (url.indexOf("?") != -1) {
                var ary = url.split("?")[1].split("&");
                for (var i in ary) {
                    str = ary[i].split("=")[0];
                    if (str == "errmsg") {
                        str_value = decodeURI(ary[i].split("=")[1]);
                        if (str_value == "Authentication failed") {
                            $("#msg").text('登入失敗，請重新檢查帳號密碼。');
                        }
                        else {
                            $("#msg").text(str_value);                            
                        }
                    }
                }
            }           
        });        
    </script>    
</html>
